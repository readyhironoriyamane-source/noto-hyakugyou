# 未使用資産クレンジング報告書

## 1. 概要
本プロジェクト「noto-hyakugyou」において、未使用資産の段階的クレンジングを実施しました。
最優先事項である「見た目を一ミリも変えない」ことを厳守するため、主要ルートのスクリーンショットによる差分比較（Visual Regression Testing）を行いながら作業を進めました。

## 2. 実施内容

### Phase 1: 棚卸し
- **主要ルートの特定**: `App.tsx` および `industries.ts` を解析し、以下のルートを特定しました。
  - `/` (Home)
  - `/contact`
  - `/privacy`
  - `/supports`
  - `/industry/:id` (101, 102, 104, 105, 106)
  - `/404`
- **基準スクリーンショットの撮影**: Puppeteerを使用し、PC（1440px）およびSP（390px）サイズで上記全ルートのスクリーンショットを撮影・保存しました。
- **未使用資産の検出**: `ts-prune` を使用して未使用のexportを検出し、さらに `grep` でプロジェクト内での使用状況をクロスチェックしました。

### Phase 2: 削除と検証
以下のコンポーネントを削除対象として試行しましたが、視覚的リグレッションテストで差分が検出されたため、**削除を中止し、元の状態に復元しました**。

**削除試行コンポーネント一覧:**
- `accordion.tsx`
- `alert-dialog.tsx`
- `aspect-ratio.tsx`
- `avatar.tsx`
- `breadcrumb.tsx`
- `calendar.tsx`
- `checkbox.tsx`
- `collapsible.tsx`
- `command.tsx`
- `context-menu.tsx`

**検証結果（失敗）:**
- `home-pc.png`: 11ピクセルの差分
- `home-sp.png`: 4580ピクセルの差分
- **原因**: 削除したコンポーネントの一部が、動的なインポートや間接的な依存関係を通じて使用されていた、あるいはグローバルなスタイルに影響を与えていた可能性があります。特にSP版での大きな差分は、レスポンシブデザインに関連するスタイルが失われたことを示唆しています。

## 3. 今後の運用について（再発防止）

### 未使用資産の検出
定期的に以下のコマンドを実行し、未使用のexportをチェックすることを推奨します。
```bash
pnpm ts-prune | grep -v "used in module"
```

### 視覚的リグレッションテスト
変更を加える際は、以下の手順で見た目に影響がないか確認できます。
1. `node capture_screenshots.js` を実行し、現状を保存（基準）。
2. コードを変更。
3. 再度 `node capture_screenshots.js` を実行し、変更後を保存。
4. `node compare_screenshots.js` を実行し、差分がないか確認。

## 4. 結論
今回特定された未使用コンポーネントの削除を試みましたが、視覚的な変化が発生したため、安全を優先して作業をロールバックしました。「見た目を一ミリも変えない」という要件を厳守するため、これ以上の削除はリスクが高いと判断しました。
